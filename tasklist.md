# Список задач проекта LLM Telegram-ассистент

## Текущие задачи

### MVP Telegram-бот для консультаций - В процессе
**Описание:** Быстрый запуск минимального Telegram-бота для консультаций с хранением данных в локальной БД и промптами в файле. Предусмотрена возможность смены типа БД.
**Приоритет:** Высокий
**Исполнитель:** LLM
**Итерация:** 1

#### Шаги выполнения
1. [x] Реализация Telegram-бота с приветствием и сбором контактов (соблюдать PEP8, отступы 2 пробела, snake_case)
2. [x] Ответы на FAQ (промпты из файла, оформление по code_conventions.md)
3. [x] Сбор и хранение контактных данных и истории в SQLite или файле (структура и имена по соглашениям)
4. [x] Сохранение полной истории сообщений пользователя и ассистента (user/assistant, время, user_id, текст) для анализа, аудита и персонализации
5. [x] Абстракция слоя хранения (легкая смена типа БД, оформление кода по соглашениям)
6. [x] Минимальный каталог услуг (1-2 позиции, оформление данных по соглашениям, поддержка разных источников: файл, БД, облако)
7. [ ] Логирование (оформление кода и структуры по соглашениям, поддержка разных источников: файл, БД, облако, INFO — только ключевые события, DEBUG — подробные сообщения, настройка уровня через .env, рекомендации по ротации/хранению)
8. [x] Документация по запуску и настройке (README.md, docstring)
9. [x] Использование conda-окружения, фиксация зависимостей в environment.yml
10. [x] Вынести все секреты и переменные окружения в .env, использовать python-dotenv, добавить .env в .gitignore, описать переменные в README.md
11. [x] Покрытие тестами не менее 99% для ключевых модулей (тесты в tests/, оформление по соглашениям)
12. [x] Все изменения оформить через pull request с ревью и описанием
13. [x] Проверка линтером (см. раздел "Правила автоматической проверки кода")

#### Комментарии
- 2024-06-25: Итерация 1 — MVP, фокус на скорости запуска
- 2024-07-06: В требования MVP добавлено обязательное сохранение полной истории сообщений пользователя и ассистента для анализа, аудита и персонализации
- 2024-07-07: В требования MVP добавлено: логирование должно поддерживать разные источники хранения (файл, БД, облако)
- 2024-07-08: В требования MVP добавлено: логирование на INFO — только ключевые события, подробные сообщения — на DEBUG, настройка уровня через .env, рекомендации по ротации/хранению
- 2024-07-08: Шаги 1–6 выполнены, текущий шаг — 7 (логирование). Шаги 8, 9, 10 (документация, conda-окружение, секреты/.env) выполнены. Остальные шаги будут выполняться последовательно.
- 2024-07-08: Шаг 13 — код успешно прошёл проверку линтером ruff, критических ошибок не обнаружено.

### Расширение сценариев и гибкости - В очереди
**Описание:** Добавление новых сценариев, расширение промптов, улучшение структуры хранения, простая аналитика, подготовка к локализации.
**Приоритет:** Высокий
**Исполнитель:** LLM
**Итерация:** 2

#### Шаги выполнения
1. [ ] Добавление новых сценариев выявления потребностей (оформление промптов по соглашениям)
2. [ ] Возможность редактирования промптов без перезапуска (структура и код по соглашениям)
3. [ ] Улучшение структуры хранения (ORM, миграции, оформление кода по соглашениям)
4. [ ] Простейшая аналитика (код и структура по соглашениям)
5. [ ] Поддержка структуры для локализации (оформление файлов по соглашениям)
6. [ ] Использование conda-окружения, фиксация зависимостей в environment.yml
7. [ ] Вынести все секреты и переменные окружения в .env, использовать python-dotenv, добавить .env в .gitignore, описать переменные в README.md
8. [ ] Документация и тесты (покрытие не менее 99%)
9. [ ] Все изменения через pull request с ревью
10. [ ] Проверка линтером (см. раздел "Правила автоматической проверки кода")

#### Комментарии
...

### Интеграция и автоматизация - В очереди
**Описание:** Интеграция с внешней БД, CRM, веб-интерфейс для лидов, расширенная аналитика, сбор обратной связи.
**Приоритет:** Средний
**Исполнитель:** LLM
**Итерация:** 3

#### Шаги выполнения
1. [ ] Интеграция с внешней БД (оформление кода и структуры по соглашениям)
2. [ ] Интеграция с CRM (оформление кода по соглашениям)
3. [ ] Веб-интерфейс для просмотра/экспорта лидов (оформление кода и структуры по соглашениям)
4. [ ] Расширенная аналитика (оформление кода по соглашениям)
5. [ ] Система сбора обратной связи (оформление кода по соглашениям)
6. [ ] Использование conda-окружения, фиксация зависимостей в environment.yml
7. [ ] Вынести все секреты и переменные окружения в .env, использовать python-dotenv, добавить .env в .gitignore, описать переменные в README.md
8. [ ] Документация и тесты (покрытие не менее 99%)
9. [ ] Все изменения через pull request с ревью
10. [ ] Проверка линтером (см. раздел "Правила автоматической проверки кода")

#### Комментарии
...

### Масштабирование и продвинутая автоматизация - В очереди
**Описание:** Масштабирование, поддержка нескольких операторов, автоматизация обновления промптов, мониторинг, расширенная локализация.
**Приоритет:** Средний
**Исполнитель:** LLM
**Итерация:** 4

#### Шаги выполнения
1. [ ] Масштабирование (Docker, облако, оформление кода по соглашениям)
2. [ ] Поддержка нескольких операторов/ботов (оформление кода по соглашениям)
3. [ ] Автоматическое обновление промптов (оформление кода и файлов по соглашениям)
4. [ ] Система мониторинга и алертов (оформление кода по соглашениям)
5. [ ] Расширенная локализация (оформление файлов по соглашениям)
6. [ ] Использование conda-окружения, фиксация зависимостей в environment.yml
7. [ ] Вынести все секреты и переменные окружения в .env, использовать python-dotenv, добавить .env в .gitignore, описать переменные в README.md
8. [ ] Документация и тесты (покрытие не менее 99%)
9. [ ] Все изменения через pull request с ревью
10. [ ] Проверка линтером (см. раздел "Правила автоматической проверки кода")

#### Комментарии
...

### Экосистема и AI-улучшения - В очереди
**Описание:** Интеграция с несколькими LLM (все модели поддерживают OpenAI-протокол, определение модели по умолчанию через переменную окружения, выбор модели командой в чате, список моделей и сервисов настраивается через внешний файл или другие источники по аналогии с промптами (БД, облачный диск), автоматическое обучение, голосовой ввод/вывод, поддержка других мессенджеров, API для внешних сервисов.
**Приоритет:** Низкий
**Исполнитель:** LLM
**Итерация:** 5

#### Шаги выполнения
1. [x] Интеграция с несколькими LLM (оформление кода по соглашениям, поддержка OpenAI-протокола, определение модели по умолчанию через переменную окружения, выбор модели командой в чате, список моделей и сервисов настраивается через внешний файл или другие источники по аналогии с промптами (БД, облачный диск)
2. [ ] Автоматическое обучение на новых данных (оформление кода по соглашениям)
3. [ ] Голосовой ввод/вывод (оформление кода по соглашениям)
4. [ ] Интеграция с другими мессенджерами (оформление кода по соглашениям)
5. [ ] API для внешних сервисов (оформление кода по соглашениям)
6. [ ] Использование conda-окружения, фиксация зависимостей в environment.yml
7. [ ] Вынести все секреты и переменные окружения в .env, использовать python-dotenv, добавить .env в .gitignore, описать переменные в README.md
8. [ ] Документация и тесты (покрытие не менее 99%)
9. [ ] Все изменения через pull request с ревью
10. [ ] Проверка линтером (см. раздел "Правила автоматической проверки кода")

#### Комментарии
...

## Завершенные задачи

...

## Отложенные задачи

...

## Правила автоматической проверки кода
- Для Python-проектов рекомендуется использовать:
  - ruff — основной линтер (стиль, ошибки, best practices)
  - black — автоформаттер (по желанию, для единообразия форматирования)
  - mypy — для строгой проверки типов (опционально)
- Инструменты должны быть добавлены в environment.yml и описаны в README.md
- Все изменения, влияющие на качество кода, должны быть согласованы через pull request 